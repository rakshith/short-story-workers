name = "create-story-worker"
main = "src/index.ts"
compatibility_date = "2024-11-06"
compatibility_flags = ["nodejs_compat"]

[env.staging]
name = "create-story-worker-staging"

[env.production]
name = "create-story-worker-production"

# R2 Bucket bindings
[[r2_buckets]]
binding = "IMAGES_BUCKET"
bucket_name = "images"
preview_bucket_name = "images"

[[r2_buckets]]
binding = "AUDIO_BUCKET"
bucket_name = "audio"
preview_bucket_name = "audio"

# Queue for async processing
[[queues.producers]]
queue = "story-processing"
binding = "STORY_QUEUE"

[[queues.consumers]]
queue = "story-processing"
max_batch_size = 1
max_batch_timeout = 30

# Environment variables (set via wrangler secret put or dashboard)
# SUPABASE_URL
# SUPABASE_ANON_KEY
# SUPABASE_SERVICE_ROLE_KEY
# REPLICATE_API_TOKEN
# OPENAI_API_KEY
# ELEVENLABS_API_KEY
# ELEVENLABS_DEFAULT_VOICE_ID
# ELEVENLABS_MODEL_ID

